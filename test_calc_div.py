# -*- coding: utf-8 -*-

import unittest

from calc_div import parse_dividends


class TestParseDiv(unittest.TestCase):

    def test_parse_div(self):
        divs = [
            ['30.03.2022', '30.03.2022', '2022', '0.1'],
            ['12.04.2022', '12.04.2022', '2022', '0.15'],
            ['30.12.2022', '30.12.2022', '2022', '0.2'],
            ['30.06.2022', '30.06.2022', '2022', '0.22'],
            ['17.03.2021', '07.06.2021', '2021', '0.33']
        ]
        result = parse_dividends(divs, 2021, 2023, 'Q')
        self.assertEqual(result, [0, 0.33, 0, 0, 0.1, 0.37, 0, 0.2])

    def test_parse_div_for_tatneft(self):
        table = [
                [],
                [],
                [],
                [],
                [],
                ['n/a', '11.10.2023 (прогноз)', 'n/a', '47.29'],
                ['n/a', '03.07.2023 (прогноз)', 'n/a', '15.95'],
                ['n/a', '10.01.2023 (прогноз)', 'n/a', '15.95'],
                ['16.08.2022', '11.10.2022', '2022', '32.71'],
                ['23.05.2022', '08.07.2022', '2022', '16.14'],
                ['23.11.2021', '10.01.2022', '2021', '9.98'],
                ['26.08.2021', '12.10.2021', '2021', '16.52'],
                ['28.04.2021', '09.07.2021', '2021', '12.3'],
                ['18.08.2020', '12.10.2020', '2020', '9.94'],
                ['22.04.2020', '30.06.2020', '2020', '1'],
                ['15.11.2019', '30.12.2019', '2019', '24.36'],
                ['06.08.2019', '27.09.2019', '2019', '40.11'],
                ['26.04.2019', '05.07.2019', '2019', '32.38'],
                ['13.11.2018', '09.01.2019', '2018', '22.26'],
                ['14.08.2018', '12.10.2018', '2018', '30.27'],
                ['24.04.2018', '06.07.2018', '2018', '12.16'],
                ['07.11.2017', '23.12.2017', '2017', '27.78'],
                ['27.04.2017', '07.07.2017', '2017', '22.81'],
                ['25.04.2016', '08.07.2016', '2016', '10.96'],
                ['27.04.2015', '15.07.2015', '2015', '10.58'],
                ['28.04.2014', '16.07.2014', '2014', '8.23'],
                ['29.04.2013', '13.05.2013', '2013', '8.6'],
                ['03.04.2012', '14.05.2012', '2012', '7.08'],
                ['28.02.2011', '06.05.2011', '2011', '5.02'],
                ['30.04.2010', '01.02.2010', '2010', '6.56'],
                ['28.04.2009', '12.05.2009', '2009', '4.42'],
                ['26.06.2008', '12.05.2008', '2008', '5.65'],
                ['02.05.2007', '14.05.2007', '2007', '4.6'],
                ['31.01.2006', '15.05.2006', '2006', '1'],
                ['28.09.2004', '01.10.2004', '2004', '1'],
                ['07.05.2004', '10.05.2004', '2004', '1']
            ]
        result = parse_dividends(table, 2006, 2022)
        self.assertEqual(result, [1.0,
                                  4.6,
                                  5.65,
                                  4.42,
                                  6.56,
                                  5.02,
                                  7.08,
                                  8.6,
                                  8.23,
                                  10.58,
                                  10.96,
                                  50.59,
                                  42.43,
                                  119.11,
                                  10.94,
                                  28.82])
